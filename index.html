<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PhÃ¢n tÃ­ch cáº§u TÃ i Xá»‰u</title>

<style>
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:-apple-system,BlinkMacSystemFont;
  display:flex;
  justify-content:center;
}
.app{
  width:92%;
  max-width:420px;
  margin-top:20px;
  background:#0b0b0b;
  border-radius:20px;
  padding:20px;
  box-shadow:0 0 25px rgba(255,215,0,.35);
}
h1{text-align:center;color:gold;}
input{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:none;
  font-size:16px;
}
.btn{
  width:100%;
  padding:14px;
  margin-top:14px;
  border:none;
  border-radius:14px;
  background:linear-gradient(90deg,gold,orange);
  font-size:18px;
  font-weight:bold;
}
.card{
  margin-top:16px;
  background:#111;
  padding:14px;
  border-radius:14px;
}
</style>
</head>

<body>
<div class="app">
<h1>ğŸ“Š PhÃ¢n tÃ­ch cáº§u</h1>

<input id="input" placeholder="VD: T X T T X T T X">

<button class="btn" onclick="analyze()">PHÃ‚N TÃCH</button>
<button class="btn" onclick="toggleMusic()">ğŸµ Báº¬T / Táº®T NHáº C</button>
<div class="card" id="output">ChÆ°a cÃ³ dá»¯ liá»‡u</div>
</div>

<script>
function analyze(){
  let raw = document.getElementById("input").value.toUpperCase();
  let arr = raw.replace(/[^TX]/g,"").split("");
  let n = arr.length;

  if(n < 6){
    output("âš ï¸ Cáº§n Ã­t nháº¥t 6 vÃ¡n Ä‘á»ƒ phÃ¢n tÃ­ch cáº§u nÃ¢ng cao");
    return;
  }

  let scores = [];
  let last = arr[n-1];

  // 1ï¸âƒ£ Bá»†T
  let streak = 1;
  for(let i=n-1;i>0;i--){
    if(arr[i]===arr[i-1]) streak++;
    else break;
  }
  if(streak>=3){
    scores.push({
      name:`ğŸ”¥ Bá»‡t ${arr[n-1]==="T"?"TÃ€I":"Xá»ˆU"} (${streak})`,
      predict:last,
      score:70 + streak*3
    });
  }

  // 2ï¸âƒ£ Äáº¢O 1â€“1
  let isAlt=true;
  for(let i=n-1;i>n-6;i--){
    if(arr[i]===arr[i-1]) isAlt=false;
  }
  if(isAlt){
    scores.push({
      name:"âš¡ Cáº§u Ä‘áº£o 1â€“1",
      predict:last==="T"?"Xá»ˆU":"TÃ€I",
      score:72
    });
  }

  // 3ï¸âƒ£ Cáº¦U 2â€“1 / 3â€“1
  let seq = arr.slice(-6).join("");
  if(/(TTX){1,}/.test(seq) || /(XXT){1,}/.test(seq)){
    scores.push({
      name:"ğŸ” Cáº§u 2â€“1",
      predict:last==="T"?"Xá»ˆU":"TÃ€I",
      score:74
    });
  }
  if(/(TTTX){1,}/.test(seq) || /(XXXT){1,}/.test(seq)){
    scores.push({
      name:"ğŸ” Cáº§u 3â€“1",
      predict:last==="T"?"Xá»ˆU":"TÃ€I",
      score:78
    });
  }

  // 4ï¸âƒ£ THá»NG KÃŠ NGHIÃŠNG
  let t = arr.filter(x=>x==="T").length;
  let x = n - t;
  scores.push({
    name:"ğŸ“Š Thá»‘ng kÃª nghiÃªng",
    predict: t>x ? "TÃ€I" : "Xá»ˆU",
    score: 60 + Math.abs(t-x)*2
  });

  // CHá»ŒN Cáº¦U Máº NH NHáº¤T
  scores.sort((a,b)=>b.score-a.score);
  let best = scores[0];

  let html = `
  ğŸ§  Cáº§u máº¡nh nháº¥t:<br>
  <b>${best.name}</b><br><br>
  ğŸ”® Gá»£i Ã½ vÃ¡n sau:
  <b style="color:gold">${best.predict}</b><br>
  ğŸ“ˆ Äá»™ tin cáº­y: <b>${best.score}%</b><br><br>
  <hr>
  <b>So sÃ¡nh cáº§u:</b><br>
  `;

  scores.forEach(s=>{
    html += `â€¢ ${s.name}: ${s.predict} (${s.score}%)<br>`;
  });

  document.getElementById("output").innerHTML = html;
}

function output(txt){
  document.getElementById("output").innerText = txt;
}
  let music = new Audio("https://cdn.pixabay.com/audio/2022/03/15/audio_4c8b9a7b8a.mp3");
music.loop = true;
music.volume = 0.4;

function toggleMusic(){
  if(music.paused){
    music.play();
    alert("ğŸµ ÄÃ£ báº­t nháº¡c");
  }else{
    music.pause();
    alert("ğŸ”‡ ÄÃ£ táº¯t nháº¡c");
  }
}
</script>
</body>
</html>

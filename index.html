<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>AI TÃ i Xá»‰u â€“ Cáº¥p 4</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;
  background:radial-gradient(circle at top,#1c2045,#05060d);
  color:#fff;font-family:system-ui;text-align:center
}
h1{color:#ffd700;text-shadow:0 0 14px #ff9800}
button{
  padding:14px 22px;margin:8px;font-size:16px;border:none;border-radius:16px;
  font-weight:600;box-shadow:0 8px 22px rgba(0,0,0,.6)
}
.tai{background:linear-gradient(45deg,#ff5722,#ff9800)}
.xiu{background:linear-gradient(45deg,#03a9f4,#00e5ff)}
.panel{background:rgba(15,20,45,.92);border-radius:20px;padding:14px;margin:10px}
.big{font-size:30px;font-weight:700}
.small{font-size:14px;opacity:.85}
.good{color:#7CFF00}.mid{color:#ffd54f}.bad{color:#ff5252}

/* ğŸ² XÃ NGáº¦U 4D */
.dice-area{display:flex;justify-content:center;gap:18px;margin:16px 0;perspective:800px}
.dice{
  width:64px;height:64px;border-radius:14px;background:linear-gradient(135deg,#fff,#ddd);
  color:#000;font-size:28px;font-weight:700;display:flex;align-items:center;justify-content:center;
  box-shadow:inset 0 0 8px rgba(0,0,0,.3),0 14px 30px rgba(0,0,0,.7)
}
@keyframes shake{
  0%{transform:rotateX(0) rotateY(0)}
  25%{transform:rotateX(180deg) rotateY(90deg)}
  50%{transform:rotateX(360deg) rotateY(180deg)}
  75%{transform:rotateX(540deg) rotateY(360deg)}
  100%{transform:rotateX(720deg) rotateY(540deg)}
}
</style>
</head>

<body>
<h1>ğŸ¤– AI TÃ€I Xá»ˆU â€“ Cáº¤P 4</h1>

<button class="tai" onclick="add('T')">ğŸ”¥ TÃ€I</button>
<button class="xiu" onclick="add('X')">â„ï¸ Xá»ˆU</button>

<div class="panel" id="history">Cáº§u: trá»‘ng</div>

<div class="dice-area">
  <div class="dice" id="dice1">?</div>
  <div class="dice" id="dice2">?</div>
  <div class="dice" id="dice3">?</div>
</div>

<div class="panel">
  <div class="small">ğŸ”® Dá»± Ä‘oÃ¡n vÃ¡n sau (AI Cáº¥p 4)</div>
  <div id="predict" class="big">â€”</div>
  <div id="percent" class="big">â€”</div>
  <div id="status" class="small">Äang táº£i AIâ€¦</div>
</div>

<script>
// =======================
// ğŸ² XÃ NGáº¦U
// =======================
function rollDice(){
  let d=[dice1,dice2,dice3];
  d.forEach(x=>{x.style.animation="none";x.offsetHeight;x.style.animation="shake 1.1s ease-in-out";});
  setTimeout(()=>d.forEach(x=>x.innerText=Math.ceil(Math.random()*6)),900);
}

// =======================
// ğŸ“Š Lá»ŠCH Sá»¬
// =======================
let h=[];

// =======================
// ğŸ§  AI Cáº¤P 4 â€“ LOAD DATA
// =======================
let AI4=null;
fetch("stats.json")
  .then(r=>r.json())
  .then(d=>{
    AI4=d;
    document.getElementById("status").innerText="AI sáºµn sÃ ng";
  })
  .catch(()=>{
    document.getElementById("status").innerText="âŒ KhÃ´ng táº£i Ä‘Æ°á»£c stats.json";
  });

// =======================
// ğŸ§  AI Cáº¤P 4 â€“ PHÃ‚N TÃCH
// =======================
function runAI4(history){
  if(!AI4 || history.length<10){
    return {pick:"â€”",pct:0,status:"Cáº§n â‰¥ 10 vÃ¡n"};
  }

  // chuá»—i 10 vÃ¡n gáº§n nháº¥t
  let seq = history.slice(-10).map(v=>v==="T"?1:0).join("");
  let row = AI4.find(r=>r.pattern===seq);
  if(!row){
    return {pick:"â€”",pct:0,status:"ğŸš« NO BET (khÃ´ng cÃ³ máº«u)"};
  }

  let pT=row.p_tai, pX=row.p_xiu;
  let pick=pT>=pX?"T":"X";
  let conf=Math.max(pT,pX);

  // Filter nhiá»…u
  let flips=0;
  for(let i=1;i<history.length;i++) if(history[i]!==history[i-1]) flips++;
  let noise=flips/history.length;
  if(noise>0.6) conf*=0.8;

  if(conf<0.55){
    return {pick:"â€”",pct:Math.round(conf*100),status:"ğŸš« NO BET"};
  }

  let pct=Math.min(78,Math.round(conf*100));
  let status=pct>=68?"ğŸŸ¢ Cáº§u Ä‘áº¹p":pct>=60?"ğŸŸ¡ Cáº§u trung bÃ¬nh":"ğŸ”´ Cáº§u nguy hiá»ƒm";
  return {pick,pct,status};
}

// =======================
// â• NHáº¬P VÃN
// =======================
function add(v){
  h.push(v); if(h.length>120) h.shift();
  document.getElementById("history").innerText="Cáº§u: "+h.join(" ");
  rollDice();

  let r=runAI4(h);
  document.getElementById("predict").innerText =
    r.pick==="T"?"ğŸ”¥ TÃ€I":r.pick==="X"?"â„ï¸ Xá»ˆU":"â€”";
  document.getElementById("percent").innerText = r.pct? r.pct+"%":"â€”";
  let s=document.getElementById("status");
  s.innerText=r.status;
  s.className="small "+(r.pct>=68?"good":r.pct>=60?"mid":"bad");
}
</script>
</body>
</html>
